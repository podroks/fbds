#!/bin/bash
msg="$(head -n1 "$1")"

# Regex Bash : Gitmoji + espace + [branch] + espace + message
rx='^(🎨|⚡️|🔥|🐛|🚑️|✨|📝|🚀|💄|🎉|✅|🔒️|🔐|🔖|🚨|🚧|💚|⬇️|⬆️|📌|👷|📈|♻️|➕|➖|🔧|🔨|🌐|✏️|💩|⏪️|🔀|📦️|👽️|🚚|📄|💥|🍱|♿️|💡|🍻|💬|🗃️|🔊|🔇|👥|🚸|🏗️|📱|🤡|🥚|🙈|📸|⚗️|🔍️|🏷️|🌱|🚩|🥅|💫|🗑️|🛂|🩹|🧐|⚰️|🧪|👔|🩺|🧱|🧑‍💻|💸|🧵|🦺|✈️) \[[^]]+\] .+'

if ! echo "$msg" | grep -Pq "$rx"; then
  echo "🚫 Commit message invalide !"
  echo "Format attendu : <gitmoji> [branch-name] message"
  echo "Exemple : 🚀 [feature/login] Add login page"
  exit 1
fi
